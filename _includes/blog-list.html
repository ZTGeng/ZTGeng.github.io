<div class="sticky-md-top">
    <div class="d-flex justify-content-between">
        <h3 id="list_title_en" class="float-start">List</h3>
        <h3 id="list_title_zh" class="float-start" style="display: none;">列表</h3>
    </div>
    <div id="list" class="list-group">
        {% for post in site.posts limit: include.listSize %}
            {% assign mod = forloop.index | modulo: 2 %}
            <a href="{{ post.url }}"
                {% if mod == 1 %}
                    class="list-group-item list-group-item-action list-group-item-primary"
                {% else %}
                    class="list-group-item list-group-item-action"
                {% endif %}>
                <h6 class="mb-1">{{ post.title }}</h6>
                <small class="mb-1">{{ post.date | date: "%Y-%m-%d %H:%M" }}</small>
            </a>
        {% endfor %}
    </div>
    <nav aria-label="Page navigation" class="mt-2">
        <ul class="pagination">
            {% assign pageNum = site.posts.size | minus: 1 | divided_by: include.listSize | plus: 1 %}
            <li class="page-item"><a class="page-link" href="javascript:void(0)"  onclick="refreshList(1)">&laquo;</a></li>
            {% for i in (1..pageNum) %}
                <li class="page-item"><a class="page-link" href="javascript:void(0)" onclick="refreshList({{ i }})">{{ i }}</a></li>
            {% endfor %}
            <li class="page-item"><a class="page-link" href="javascript:void(0)" onclick="refreshList({{ pageNum }})">&raquo;</a></li>
        </ul>
    </nav>
</div>

<script type="text/javascript">
    const posts = [
        {% for post in site.posts %}
            {
                title: "{{ post.title }}",
                date: "{{ post.date | date: "%Y-%m-%d %H:%M" }}",
                url: "{{ post.url }}"
            },
        {% endfor %}
    ];
    const listSize = {{ include.listSize }};

    const refreshList = (page) => {
        const list = document.getElementById("list");
        list.innerHTML = "";
        for (let i = 0; i < listSize; i++) {
            p = (page - 1) * listSize + i;
            if (p >= posts.length) {
                break;
            }
            const post = posts[p];
            const a = document.createElement("a");
            a.href = post.url;
            a.className = "list-group-item list-group-item-action" + (i % 2 === 0 ? " list-group-item-primary" : "");
            const h6 = document.createElement("h6");
            h6.className = "mb-1";
            h6.innerText = post.title;
            const small = document.createElement("small");
            small.className = "mb-1";
            small.innerText = post.date;
            a.appendChild(h6);
            a.appendChild(small);
            list.appendChild(a);
        }
    };

    if (window.navigator.language.startsWith("zh")) {
        document.getElementById("list_title_en").style.display = "none";
        document.getElementById("list_title_zh").style.display = "block";
    } else {
        document.getElementById("list_title_en").style.display = "block";
        document.getElementById("list_title_zh").style.display = "none";
    }
</script>